{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/vinay/Desktop/booking/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"C:/Users/vinay/Desktop/booking/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/vinay/Desktop/booking/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\vinay\\\\Desktop\\\\booking\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faCircleXmark}from\"@fortawesome/free-solid-svg-icons\";import\"./reserve.css\";import useFetch from\"../../hooks/useFetch\";import{useContext,useState}from\"react\";import{SearchContext}from\"../../context/SearchContext\";import axios from\"axios\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Reserve=function Reserve(_ref){var setOpen=_ref.setOpen,hotelId=_ref.hotelId;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),selectedRooms=_useState2[0],setSelectedRooms=_useState2[1];var _useFetch=useFetch(\"/hotels/room/\".concat(hotelId)),data=_useFetch.data,loading=_useFetch.loading,error=_useFetch.error;var _useContext=useContext(SearchContext),dates=_useContext.dates;var getDatesInRange=function getDatesInRange(startDate,endDate){var start=new Date(startDate);var end=new Date(endDate);var date=new Date(start.getTime());var dates=[];while(date<=end){dates.push(new Date(date).getTime());date.setDate(date.getDate()+1);}return dates;};var alldates=getDatesInRange(dates[0].startDate,dates[0].endDate);var isAvailable=function isAvailable(roomNumber){var isFound=roomNumber.unavailableDates.some(function(date){return alldates.includes(new Date(date).getTime());});return!isFound;};var handleSelect=function handleSelect(e){var checked=e.target.checked;var value=e.target.value;setSelectedRooms(checked?[].concat(_toConsumableArray(selectedRooms),[value]):selectedRooms.filter(function(item){return item!==value;}));};var navigate=useNavigate();var handleClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Promise.all(selectedRooms.map(function(roomId){var res=axios.put(\"/rooms/availability/\".concat(roomId),{dates:alldates});return res.data;}));case 3:setOpen(false);navigate(\"/\");_context.next=9;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);case 9:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function handleClick(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"reserve\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"rContainer\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCircleXmark,className:\"rClose\",onClick:function onClick(){return setOpen(false);}}),/*#__PURE__*/_jsx(\"span\",{children:\"Select your rooms:\"}),data.map(function(item){return/*#__PURE__*/_jsxs(\"div\",{className:\"rItem\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"rItemInfo\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rTitle\",children:item.title}),/*#__PURE__*/_jsx(\"div\",{className:\"rDesc\",children:item.desc}),/*#__PURE__*/_jsxs(\"div\",{className:\"rMax\",children:[\"Max people: \",/*#__PURE__*/_jsx(\"b\",{children:item.maxPeople})]}),/*#__PURE__*/_jsx(\"div\",{className:\"rPrice\",children:item.price})]}),/*#__PURE__*/_jsx(\"div\",{className:\"rSelectRooms\",children:item.roomNumbers.map(function(roomNumber){return/*#__PURE__*/_jsxs(\"div\",{className:\"room\",children:[/*#__PURE__*/_jsx(\"label\",{children:roomNumber.number}),/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",value:roomNumber._id,onChange:handleSelect,disabled:!isAvailable(roomNumber)})]});})})]},item._id);}),/*#__PURE__*/_jsx(\"button\",{onClick:handleClick,className:\"rButton\",children:\"Reserve Now!\"})]})});};export default Reserve;","map":{"version":3,"sources":["C:/Users/vinay/Desktop/booking/client/src/components/reserve/Reserve.jsx"],"names":["FontAwesomeIcon","faCircleXmark","useFetch","useContext","useState","SearchContext","axios","useNavigate","Reserve","setOpen","hotelId","selectedRooms","setSelectedRooms","data","loading","error","dates","getDatesInRange","startDate","endDate","start","Date","end","date","getTime","push","setDate","getDate","alldates","isAvailable","roomNumber","isFound","unavailableDates","some","includes","handleSelect","e","checked","target","value","filter","item","navigate","handleClick","Promise","all","map","roomId","res","put","title","desc","maxPeople","price","roomNumbers","number","_id"],"mappings":"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","sourcesContent":["import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faCircleXmark } from \"@fortawesome/free-solid-svg-icons\";\n\nimport \"./reserve.css\";\nimport useFetch from \"../../hooks/useFetch\";\nimport { useContext, useState } from \"react\";\nimport { SearchContext } from \"../../context/SearchContext\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst Reserve = ({ setOpen, hotelId }) => {\n  const [selectedRooms, setSelectedRooms] = useState([]);\n  const { data, loading, error } = useFetch(`/hotels/room/${hotelId}`);\n  const { dates } = useContext(SearchContext);\n\n  const getDatesInRange = (startDate, endDate) => {\n    const start = new Date(startDate);\n    const end = new Date(endDate);\n\n    const date = new Date(start.getTime());\n\n    const dates = [];\n\n    while (date <= end) {\n      dates.push(new Date(date).getTime());\n      date.setDate(date.getDate() + 1);\n    }\n\n    return dates;\n  };\n\n  const alldates = getDatesInRange(dates[0].startDate, dates[0].endDate);\n\n  const isAvailable = (roomNumber) => {\n    const isFound = roomNumber.unavailableDates.some((date) =>\n      alldates.includes(new Date(date).getTime())\n    );\n\n    return !isFound;\n  };\n\n  const handleSelect = (e) => {\n    const checked = e.target.checked;\n    const value = e.target.value;\n    setSelectedRooms(\n      checked\n        ? [...selectedRooms, value]\n        : selectedRooms.filter((item) => item !== value)\n    );\n  };\n\n  const navigate = useNavigate();\n\n  const handleClick = async () => {\n    try {\n      await Promise.all(\n        selectedRooms.map((roomId) => {\n          const res = axios.put(`/rooms/availability/${roomId}`, {\n            dates: alldates,\n          });\n          return res.data;\n        })\n      );\n      setOpen(false);\n      navigate(\"/\");\n    } catch (err) {}\n  };\n  return (\n    <div className=\"reserve\">\n      <div className=\"rContainer\">\n        <FontAwesomeIcon\n          icon={faCircleXmark}\n          className=\"rClose\"\n          onClick={() => setOpen(false)}\n        />\n        <span>Select your rooms:</span>\n        {data.map((item) => (\n          <div className=\"rItem\" key={item._id}>\n            <div className=\"rItemInfo\">\n              <div className=\"rTitle\">{item.title}</div>\n              <div className=\"rDesc\">{item.desc}</div>\n              <div className=\"rMax\">\n                Max people: <b>{item.maxPeople}</b>\n              </div>\n              <div className=\"rPrice\">{item.price}</div>\n            </div>\n            <div className=\"rSelectRooms\">\n              {item.roomNumbers.map((roomNumber) => (\n                <div className=\"room\">\n                  <label>{roomNumber.number}</label>\n                  <input\n                    type=\"checkbox\"\n                    value={roomNumber._id}\n                    onChange={handleSelect}\n                    disabled={!isAvailable(roomNumber)}\n                  />\n                </div>\n              ))}\n            </div>\n          </div>\n        ))}\n        <button onClick={handleClick} className=\"rButton\">\n          Reserve Now!\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default Reserve;\n"]},"metadata":{},"sourceType":"module"}